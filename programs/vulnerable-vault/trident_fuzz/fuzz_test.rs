//! Auto-generated Trident fuzz test for ''
//! Generated by Solana Security Swarm â€” Trident Integration
//!
//! Run with: trident fuzz run fuzz_test

use trident_fuzz::prelude::*;
use anchor_lang::prelude::*;

/// Fuzz account storage for the fuzzing campaign.
#[derive(Default)]
pub struct FuzzAccounts {
    pub vault: AccountId,
    pub authority: AccountId,
    pub payer: AccountId,
    pub system_program: AccountId,
    pub depositor: AccountId,
    pub oracle: AccountId,
    pub caller: AccountId,
    pub proposal: AccountId,
    pub voter: AccountId,
    pub user_account: AccountId,
    pub user: AccountId,
    pub source_vault: AccountId,
    pub dest_vault: AccountId,
}

#[derive(Default)]
pub struct FuzzTest {
    pub trident: TridentSVM,
    pub fuzz_accounts: FuzzAccounts,
}

impl FuzzTest {
    /// Initialize program state before fuzzing begins.
    #[init]
    fn start(&mut self) {
        // Initialize via 'initialize'
        let mut tx = InitializeTransaction::build(&mut self.trident, &mut self.fuzz_accounts);
        self.trident.execute_transaction(&mut tx, Some("initialize"));

        // Initialize via 'create_user_account'
        let mut tx = CreateUserAccountTransaction::build(&mut self.trident, &mut self.fuzz_accounts);
        self.trident.execute_transaction(&mut tx, Some("create_user_account"));

    }

    /// Fuzz flow for instruction 'handle_deposit'
    #[flow]
    fn flow_handle_deposit(&mut self) {
        let mut tx = HandleDepositTransaction::build(
            &mut self.trident,
            &mut self.fuzz_accounts,
        );
        tx.set_amount(rand::random::<u64>());
        self.trident.execute_transaction(&mut tx, Some("handle_deposit"));

        // Property: no arithmetic overflow
        // Trident monitors for panics from unchecked math
    }

    /// Fuzz flow for instruction 'handle_withdraw'
    #[flow]
    fn flow_handle_withdraw(&mut self) {
        let mut tx = HandleWithdrawTransaction::build(
            &mut self.trident,
            &mut self.fuzz_accounts,
        );
        tx.set_amount(rand::random::<u64>());
        self.trident.execute_transaction(&mut tx, Some("handle_withdraw"));

        // Property: no arithmetic overflow
        // Trident monitors for panics from unchecked math
    }

    /// Fuzz flow for instruction 'handle_get_secure_price'
    #[flow]
    fn flow_handle_get_secure_price(&mut self) {
        let mut tx = HandleGetSecurePriceTransaction::build(
            &mut self.trident,
            &mut self.fuzz_accounts,
        );
        self.trident.execute_transaction(&mut tx, Some("handle_get_secure_price"));

        // Property: no arithmetic overflow
        // Trident monitors for panics from unchecked math
    }

    /// Fuzz flow for instruction 'handle_emergency_pause'
    #[flow]
    fn flow_handle_emergency_pause(&mut self) {
        let mut tx = HandleEmergencyPauseTransaction::build(
            &mut self.trident,
            &mut self.fuzz_accounts,
        );
        self.trident.execute_transaction(&mut tx, Some("handle_emergency_pause"));

        // Property: no arithmetic overflow
        // Trident monitors for panics from unchecked math
    }

    /// Fuzz flow for instruction 'handle_vote_on_proposal'
    #[flow]
    fn flow_handle_vote_on_proposal(&mut self) {
        let mut tx = HandleVoteOnProposalTransaction::build(
            &mut self.trident,
            &mut self.fuzz_accounts,
        );
        tx.set_vote_weight(rand::random::<u64>());
        self.trident.execute_transaction(&mut tx, Some("handle_vote_on_proposal"));

        // Property: no arithmetic overflow
        // Trident monitors for panics from unchecked math
    }

    /// Fuzz flow for instruction 'handle_swap'
    #[flow]
    fn flow_handle_swap(&mut self) {
        let mut tx = HandleSwapTransaction::build(
            &mut self.trident,
            &mut self.fuzz_accounts,
        );
        tx.set_amount(rand::random::<u64>());
        self.trident.execute_transaction(&mut tx, Some("handle_swap"));

        // Property: no arithmetic overflow
        // Trident monitors for panics from unchecked math
    }

}
